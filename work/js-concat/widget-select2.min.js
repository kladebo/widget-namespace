/*! widget-select and widget-input-text2 2016-03-15 */
!function(a){var b=a.createNS("MYAPPLICATION.MODEL.WIDGETS"),c=function(){};c.prototype.init=function(a){this["native"]=a,this.widget=document.createElement("div")},c.prototype.draw=function(){this["native"].parentNode.insertBefore(this.widget,this["native"].nextSibling),this.widget.appendChild(this["native"]),this.widget.className="widget-input"},b.TextBox=c}(MYAPPLICATION),function(a){"use strict";var b,c=a.createNS("MYAPPLICATION.MODEL.WIDGETS");b=function(){},b.prototype.create=function(a){this.widget=a,this.item=document.createElement("li"),this.widget.guiFilterBar||(this.widget.guiFilterBar=document.createDocumentFragment(),console.log("Please put a element on the page with 'select-widget-filterbar' as className")),this.widget.filterItems||(this.widget.filterItems=[],this.widget.guiFilterGroup=document.createElement("ul"),this.widget.guiFilterBar.appendChild(this.widget.guiFilterGroup),this.widget.guiFilterGroup.setAttribute("role","presentation"),this.widget.guiFilterGroup.className="widget-filter-group"),this.itemId=this.widget.filterItems.push(this.item)-1,this.draw()},b.prototype.draw=function(){var a=this.widget,b=this.itemId;a.guiFilterGroup.appendChild(this.item),this.item.innerHTML=a["native"][b].value,this.item.selected=a["native"][b].selected,this.item.setAttribute("role","option"),this.item.className="widget-filter-item"+(this.item.selected?" active":""),this.item.addEventListener("click",function(d){if(!d)var d=window.event;d.cancelBubble=!0,d.stopPropagation&&d.stopPropagation(),a.optionId=b,c.Select.activeSelect=a,c.Select.optionClicked()})},c.SelectFilter=b}(MYAPPLICATION),function(a){"use strict";var b,c=a.MODEL.HELPERS,d=a.createNS("MYAPPLICATION.MODEL.WIDGETS");b=function(){},b.prototype.create=function(a){this.widget=a,this.item=document.createElement("li"),this.widget.optionItems=this.widget.optionItems||[],this.itemId=this.widget.optionItems.push(this.item)-1,this.draw()},b.prototype.draw=function(){var a=this.widget,b=this.itemId;a.guiDropDown.appendChild(this.item),this.item.textContent=a["native"][b].textContent,this.item.selected=a["native"][b].selected,this.item.setAttribute("role","option"),this.item.className="widget-dropdown-item"+(this.item.selected?" active":""),!a.isMultiple&&this.item.selected&&(a.guiValue.textContent=this.item.textContent),this.item.addEventListener("click",function(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),a.optionId=b,d.Select.activeSelect=a,d.Select.optionClicked(),c.scrollView(a.guiDropDown,e)}),this.item.addEventListener("mouseover",function(){e()}),this.item.addEventListener("mouseout",function(){f()});var e=function(){a.highlightId=b,d.Select.optionAddHighlight()},f=function(){a.highlightId=b,d.Select.optionRemoveHighlight()}},d.SelectOption=b}(MYAPPLICATION),function(a){"use strict";var b,c,d,e,f,g,h,i=a.createNS("MYAPPLICATION.MODEL.WIDGETS");c=function(){f()},d=function(){b.optionRemoveHighlight(),delete b.activeSelect.highlightId,b.activeSelect.guiDropDown.classList.add("hidden")},e=function(){b.activeSelect.guiDropDown.classList.remove("hidden")},f=function(){b.activeSelect.guiDropDown.className.indexOf("hidden")>=0?e():d()},g=function(){var a,c,d=0,e=b.activeSelect,f=e.optionItems[e.optionId],g=e.filterItems[e.optionId];switch(e.isMultiple){case!1:if(f.classList.contains("active")){f.classList.remove("active"),g.classList.remove("active"),e.guiValue.textContent=e.title;break}for(a=0,c=e.optionItems.length;c>a;a+=1)e.optionItems[a].classList.remove("active"),e.filterItems[a].classList.remove("active");e.guiValue.textContent=f.textContent;case!0:f.classList.toggle("active"),g.classList.toggle("active")}for(a=0,c=e.filterItems.length;c>a;a+=1)e.filterItems[a].className.indexOf("active")>=0&&(d+=1);0===d?e.guiFilterGroup.classList.add("hidden"):e.guiFilterGroup.classList.remove("hidden")},h=function(){var a=b.activeSelect,c=a["native"][a.optionId];switch(a.isMultiple){case!1:if(c.selected){a["native"].selectedIndex=-1;break}case!0:c.selected=!c.selected}},b=function(){this.widgets=this.widgets||[]},b.prototype.create=function(a){var b={};this.widgets.push(b),this.activeSelect=b,b["native"]=a,b.isMultiple=a.multiple,b.title=a.getAttribute("title"),b.tabIndex=parseInt(a.getAttribute("tabIndex"),10),b.optionsLength=a.length,a.tabIndex=-1,a.classList.add("hidden")},b.prototype.draw=function(){var a,e,g,h,j,k=this.activeSelect;for(g=document.createDocumentFragment(),k.gui=document.createElement("div"),g.appendChild(k.gui),k.gui.className=k.isMultiple?"widget-select multiple":"widget-select",k.gui.tabIndex=k.tabIndex,k.guiFilterBar=document.querySelector(".select-widget-filterbar"),k.guiValue=document.createElement("span"),k.gui.appendChild(k.guiValue),k.guiValue.textContent=k.isMultiple?k.title:"",k.guiDropDown=document.createElement("ul"),k.gui.appendChild(k.guiDropDown),k.guiDropDown.setAttribute("role","presentation"),k.guiDropDown.className="widget-dropdown hidden",h=new i.SelectOption,j=new i.SelectFilter,a=0,e=k.optionsLength;e>a;a+=1)k.optionId=a,h.create(k),j.create(k);k.gui.addEventListener("click",function(){this.focus(),c()}),k.gui.addEventListener("focus",function(){i.Select.activeSelect=k}),k.gui.addEventListener("blur",function(){d()}),k.gui.addEventListener("keydown",function(a){if(!a)var a=window.event;if(a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation(),!a.altKey||38!==a.keyCode&&40!==a.keyCode){if(38===a.keyCode||40===a.keyCode){if(k.isMultiple&&k.guiDropDown.className.indexOf("hidden")>=0)return;if(k.isMultiple&&i.Select.optionRemoveHighlight(),"undefined"==typeof k.highlightId&&(k.highlightId=-1),38===a.keyCode?k.highlightId>0&&(k.highlightId-=1):40===a.keyCode&&k.highlightId<k.optionItems.length-1&&(k.highlightId+=1),k.isMultiple)i.Select.optionAddHighlight();else{if(k.optionId===k.highlightId)return;k.optionId=k.highlightId,i.Select.optionClicked()}}else if(13===a.keyCode){if(!k.isMultiple)return void f();"undefined"!=typeof b.activeSelect.highlightId&&(k.optionId=b.activeSelect.highlightId,i.Select.optionClicked())}}else f();console.log(event.keyCode)}),k["native"].parentNode.insertBefore(g,k["native"].nextSibling)},b.optionClicked=function(){h(),g()},b.optionAddHighlight=function(){"undefined"!=typeof b.activeSelect.highlightId&&b.activeSelect.optionItems[b.activeSelect.highlightId].classList.add("highlight")},b.optionRemoveHighlight=function(){"undefined"!=typeof b.activeSelect.highlightId&&b.activeSelect.optionItems[b.activeSelect.highlightId].classList.remove("highlight")},i.Select=b}(MYAPPLICATION);